<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.5.0/dist/aframe-extras.min.js"></script>
    <title>LIDM</title>
</head>
<body>
    <a-scene renderer="pixelRatio: 2">
        <a-assets>
            <img id="point1" src="/assets/ekosistem1.webp"/> 
            <audio id="bgMusic" src="/assets/suara_alam.mp3"></audio>
            <a-asset-item id="deer" src="/assets/deer_idle/scene.gltf"></a-asset-item>
            <a-asset-item id="grass1" src="/assets/grass1/scene.gltf"></a-asset-item>
            <a-asset-item id="grass2" src="/assets/grass2/scene.gltf"></a-asset-item>
            <a-asset-item id="birds" src="/assets/birds/scene.gltf"></a-asset-item>
        </a-assets>
        
        <a-sound src="#bgMusic" autoplay="true" loop="true" volume="1"></a-sound>

        <a-sky id="skybox" src="#point1" rotation="0 -90 0" material="mipmap: true;"
        rotation="0 45 0"
        event-set__mouseenter="_event: mouseenter; animation: property: scale; to: 1.05 1.05 1.05; dur: 300; easing: easeOutElastic"
         event-set__mouseleave="_event: mouseleave; animation: property: scale; to: 1 1 1; dur: 300; easing: easeOutElastic">
        </a-sky>

        <!-- LIGHT 1 -->
        <a-light type="directional" color="#FFFF" intensity="3" position="-3 40 -80" rotation="10 0 0"></a-light>

        <!-- LIGHT 2 -->
        <a-light type="directional" color="#FFFF" intensity="3" position="-30 50 40" rotation="20 120 80"></a-light>

        <a-light type="directional" color="#FFFF" intensity="5"></a-light>

        <!-- LIGHT 3 -->

            </a-plane>
        <!-- CAMERA -->
        <!-- <a-camera position="-5  1 0" fov="100" wasd-controls look-controls>
            <a-plane id="infoPanel" position="0 0 -6" width="11" height="7" color="#333" material="opacity: 0.6"
                     text="value: Informasi; color: white; align: center">
            </a-plane>
            <a-plane id="infoPanel" position="4 -4.2 -6" width="3" height="1" color="#333" material="opacity: 0.6"
                     text="value: Previuos; color: white; align: center" width="10">
            </a-plane>
        </a-camera> -->

        <!-- OBJEK -->
        <a-entity gltf-model="#deer" position="15 -10 -15" scale="2 2 2" rotation="0 -120 0" animation-mixer></a-entity>
        <a-entity gltf-model="#grass2" position="-80 -10 -15" scale="1 1 1" rotation="0 90 0" color ="#66FF6"animation-mixer></a-entity>
        <a-entity gltf-model="#grass2" position="90 -10 -15" scale="1 1 1" rotation="0 90 0" color ="#66FF6"animation-mixer></a-entity>
        <!-- Burung dengan animasi -->
        <a-entity id="bird" gltf-model="#birds" position="-5 10 10" scale="3 3 3" rotation="10 0 -3" 
                  animation-mixer="clip: *; timeScale: 1 " 
                  animation="property: position; to: 5 20 -70; dur: 10000; easingOut: linear; loop: true ; easeIn : linear ">
        </a-entity>

        <!-- Mengembalikan burung ke posisi awal -->
 
        <script>
            // Ambil referensi ke burung
            const bird = document.querySelector('#bird');
    
            // Fungsi untuk mengulang animasi burung
            function restartBirdAnimation() {
                bird.setAttribute('animation', 'property: position; to: 5 20 -70; dur: 10000; easing: linear; loop: false');
                bird.setAttribute('visible', 'true'); // Tampilkan burung
                bird.emit('start-animation'); // Emit event untuk memulai animasi
            }
    
            // Event listener untuk menyelesaikan animasi
            bird.addEventListener('animationcomplete', function () {
                bird.setAttribute('visible', 'false'); // Sembunyikan burung saat animasi selesai
                setTimeout(restartBirdAnimation, 3000); // Jeda 3 detik sebelum memulai ulang
            });
    
            // Inisialisasi animasi
            bird.emit('start-animation');
        </script>
    </a-scene>
</body>
</html>
